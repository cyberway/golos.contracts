{
    "version": "cyberway::abi/1.1",
    "variants": [
        {
          "name": "referral_param",
          "types": [
                "breakout_parametrs",
                "expire_parametrs",
                "percent_parametrs",
                "delay_parametrs"
            ]
        }
    ],
    "structs": [
        {
            "name": "addreferral",
            "base": "",
            "fields": [
                {"type": "name", "name": "referrer"},
                {"type": "name", "name": "referral"},
                {"type": "uint32", "name": "percent"},
                {"type": "uint64", "name": "expire"},
                {"type": "asset", "name": "breakout"}
            ]
        },
        {
           "name": "breakout_parametrs",
           "base": "",
           "fields": [
              {"name": "min_breakout", "type": "asset"},
              {"name": "max_breakout", "type": "asset"}
           ]
        },
        {
           "name": "expire_parametrs",
           "base": "",
           "fields": [
              {"name": "max_expire", "type": "uint64"}
           ]
        },
        {
           "name": "percent_parametrs",
           "base": "",
           "fields": [
              {"name": "max_percent", "type": "uint32"}
           ]
        },
        {
           "name": "delay_parametrs",
           "base": "",
           "fields": [
              {"name": "delay_clear_old_ref", "type": "uint32"}
           ]
        },
        {
           "name": "referral_state",
           "base": "",
           "fields": [
              {"name": "id", "type": "uint64"},
              {"name": "breakout_params", "type": "breakout_parametrs"},
              {"name": "expire_params",   "type": "expire_parametrs"},
              {"name": "percent_params",  "type": "percent_parametrs"},
              {"name": "delay_params",    "type": "delay_parametrs"}
           ]
        },
        {
           "name": "setparams",
           "base": "",
           "fields": [
              {"name": "params", "type": "referral_param[]"}
           ]
        },
        {
           "name": "empty",
           "base": "",
           "fields": [ ]
        }
    ],
    "actions": [
        {
            "name": "addreferral",
            "type": "addreferral"
        },
        {
            "name": "validateprms",
            "type": "setparams"
        },
        {
            "name": "setparams",
            "type": "setparams"
        },
        {
            "name": "closeoldref",
            "type": "empty"
        }
    ],
    "tables": [
        {
            "name": "referrals",
            "type": "addreferral",
            "indexes" : [
                {
                    "name": "primary",
                    "unique": true,
                    "orders": [
                        {"field": "referral", "order": "asc"}
                    ]
                },
                {
                    "name": "referrerkey",
                    "unique": false,
                    "orders": [
                        {"field": "referrer", "order": "asc"}
                    ]
                },
                {
                    "name": "expirekey",
                    "unique": false,
                    "orders": [
                        {"field": "expire", "order": "asc"}
                    ]
                }
            ]
        },
        {
            "name": "refparams",
            "type": "referral_state",
            "indexes" : [
                {
                    "name": "primary",
                    "unique": true,
                    "orders": [
                        {"field": "id", "order": "asc"}
                    ]
                }
            ]
        }
    ],
    "abi_extensions": []
}
